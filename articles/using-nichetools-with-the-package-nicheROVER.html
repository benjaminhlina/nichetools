<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using {nichetools} with nicheROVER â€¢ nichetools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using {nichetools} with nicheROVER">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nichetools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/using-nichetools-with-the-package-nicheROVER.html">Using {nichetools} with nicheROVER</a></li>
    <li><a class="dropdown-item" href="../articles/using-nichetools-with-the-package-SIBER.html">Using {nichetools} with SIBER</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/benjaminhlina/nichetools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using {nichetools} with nicheROVER</h1>
                        <h4 data-toc-skip class="author">Benjamin L.
Hlina</h4>
            
            <h4 data-toc-skip class="date">2024-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/benjaminhlina/nichetools/blob/main/vignettes/using-nichetools-with-the-package-nicheROVER.Rmd" class="external-link"><code>vignettes/using-nichetools-with-the-package-nicheROVER.Rmd</code></a></small>
      <div class="d-none name"><code>using-nichetools-with-the-package-nicheROVER.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="our-objectives">Our Objectives<a class="anchor" aria-label="anchor" href="#our-objectives"></a>
</h3>
<p>The purpose of this vignette is to use <a href="https://cran.r-project.org/package=nicheROVER" class="external-link">{nicheROVER}</a>
and <a href="https://benjaminhlina.github.io/nichetools/">{nichetools}</a> to
extract and then visualize estimates of trophic niche size and
similarities for multiple freshwater fish using <a href="https://ggplot2.tidyverse.org/" class="external-link">{ggplot2}</a>.</p>
<p>This vignette can be used for additional purposes including
estimating niche size and similarities among different groups of aquatic
and/or terrestrial species. Furthermore, niche size and similarities for
different behaviours exhibited within a population can be made using
behavioural data generated from acoustic telemetry (e.g., differences in
habitat occupancy).</p>
</div>
<div class="section level3">
<h3 id="bring-in-trophic-niche-data">Bring in trophic niche data<a class="anchor" aria-label="anchor" href="#bring-in-trophic-niche-data"></a>
</h3>
<p>First we will load the necessary packages to preform the analysis and
visualization. We will use <a href="https://cran.r-project.org/package=nicheROVER" class="external-link">{nicheROVER}</a>
and <a href="https://benjaminhlina.github.io/nichetools/">{nichetools}</a> to
preform the analysis. We will use <a href="https://dplyr.tidyverse.org/" class="external-link">{dplyr}</a>, <a href="https://tidyr.tidyverse.org/" class="external-link">{tidyr}</a>, and <a href="https://purrr.tidyverse.org/" class="external-link">{purrr}</a> to manipulate data and
iterate processes. Lastly, we will use <a href="https://ggplot2.tidyverse.org/" class="external-link">{ggplot2}</a>, <a href="https://wilkelab.org/ggtext/" class="external-link">{ggtext}</a>, and <a href="https://patchwork.data-imaginist.com/" class="external-link">{patchwork}</a> to plot,
add labels, and arrange plots.</p>
<p>I will add that many of the <a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a> and
<a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a> functions and processes can be replaced using <a href="https://CRAN.R-project.org/package=data.table" class="external-link">{data.table}</a>
which is great when working with large data sets.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/ggtext/" class="external-link">ggtext</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/teunbrand/ggh4x" class="external-link">ggh4x</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/mlysy/nicheROVER" class="external-link">nicheROVER</a></span><span class="op">)</span> </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://benjaminhlina.github.io/nichetools/">nichetools</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For the purpose of the vignette we will be using the
<code>fish</code> data frame that is available within
<a href="https://github.com/mlysy/nicheROVER" class="external-link">nicheROVER</a>. We will remove
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î´</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math><sup>34</sup>S
for simplicity of the vignette. If more than two isotopes or metrics are
being used to compare niche sizes and similarities, please use the
functions for each pairing. Right now some functions (i.e.,
<code><a href="../reference/niche_ellipse.html">niche_ellipse()</a></code>) in <a href="https://benjaminhlina.github.io/nichetools/">nichetools</a> doesnâ€™t have
the ability to work with more than two isotopes. This will become a
feature at some point but for now. Please be patient and use the
functions for each pairing you have.</p>
<p>We will first use the function <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">janitor::clean_names()</a></code> to
clean up column names. For your purposes you will need to replace fish
with your data frame either by loading a csv, rds, or qs, with your
data. You can do this multiple ways, I prefer using
<code>readr::read_csv()</code> but base Râ€™s <code><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv()</a></code>
works perfectly fine.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">fish</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>If there are any isotopic values that did not run and are
<code>NA</code>, they will need to be removed because
<a href="https://github.com/mlysy/nicheROVER" class="external-link">nicheROVER</a>â€™s functions will not accommodate values of
<code>NA</code>.</p>
</div>
<div class="section level3">
<h3 id="estimate-posterior-distribution-with-normal-inverse-wishart-niw-priors-">Estimate posterior distribution with Normal-Inverse-Wishart (NIW)
priors.<a class="anchor" aria-label="anchor" href="#estimate-posterior-distribution-with-normal-inverse-wishart-niw-priors-"></a>
</h3>
<p>We will take 1,000 posterior samples for each group. You can change
this but suggest nothing less than 1,000.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nsample</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></code></pre></div>
<p>We will then split the data frame into a list with each species as a
data frame object within the list, We will then iterate over the list,
using <code><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map()</a></code> from <a href="https://purrr.tidyverse.org/" class="external-link">{purrr}</a>, to estimate posterior
distribution using Normal-Inverse-Wishart (NIW) priors.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fish_par</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">d13c</span>, <span class="va">d15n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nicheROVER/man/niw.post.html" class="external-link">niw.post</a></span><span class="op">(</span>nsample <span class="op">=</span> <span class="va">nsample</span>, X <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extract-Î¼-values">Extract Î¼ values<a class="anchor" aria-label="anchor" href="#extract-%CE%BC-values"></a>
</h3>
<p>We will use <code><a href="../reference/extract_mu.html">extract_mu()</a></code>to extract posteriors for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¼</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
estimates. The default output of <code><a href="../reference/extract_mu.html">extract_mu()</a></code> is long
format which works for plotting with {ggplot2} and other functions in
{nichetools}. If we want wide format we can specify the argument
<code>format</code> with <code>"wide"</code>, however, it is unlikely
you will need this data in wide format.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_mu.html">extract_mu</a></span><span class="op">(</span><span class="va">fish_par</span><span class="op">)</span></span></code></pre></div>
<p>The default output will be lacking some info for plotting. We will
need to add in a column that is the element abbreviation and neutron
number to be used in axis labeling.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_mu</span> <span class="op">&lt;-</span> <span class="va">df_mu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    element <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="st">"N"</span>,</span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="st">"C"</span>,</span>
<span>    <span class="op">)</span>, </span>
<span>    neutron <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="fl">15</span>,</span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="fl">13</span>,</span>
<span>    <span class="op">)</span> </span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extract-Ïƒ-values">Extract Î£ values<a class="anchor" aria-label="anchor" href="#extract-%CF%83-values"></a>
</h3>
<p>We will use <code><a href="../reference/extract_sigma.html">extract_sigma()</a></code> to extract posterior
estimates for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>.
The default output of <code><a href="../reference/extract_sigma.html">extract_sigma()</a></code> is wide format which
doesnâ€™t work for plotting with {ggplot2} but does work other functions
in {nichetools}. If we want long for plotting we can specify the
argument <code>format</code> with <code>"long"</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_sigma.html">extract_sigma</a></span><span class="op">(</span><span class="va">fish_par</span><span class="op">)</span></span></code></pre></div>
<p>For plotting we will need the extracted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
values to be in long format. We also need to remove
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
values for when the both isotope columns are the same isotope.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sigma_cn</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_sigma.html">extract_sigma</a></span><span class="op">(</span><span class="va">fish_par</span>, </span>
<span>                             data_format <span class="op">=</span> <span class="st">"long"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">id</span> <span class="op">!=</span> <span class="va">isotope</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-posterior-distrubtion-of-Î¼-and-Ïƒ">Plot posterior distrubtion of Î¼ and Î£<a class="anchor" aria-label="anchor" href="#plot-posterior-distrubtion-of-%CE%BC-and-%CF%83"></a>
</h3>
<p>For most plotting within this vignette, I will <code><a href="https://rdrr.io/r/base/split.html" class="external-link">split()</a></code>
the data frame by isotope, creating a list that I will then use
<code><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap()</a></code> to iterate over the list to create plots. We will
use <code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density()</a></code> to represent densities for both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¼</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>.
Plot objects will then be stored in a list.</p>
<p>First we will plot
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¼</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
for each isotope. We will use <a href="https://patchwork.data-imaginist.com/" class="external-link">{patchwork}</a> to
configure plots for multi-panel figures. This package is phenomenal and
uses math operators to configure and manipulate the plots to create
multi-panel figures.</p>
<p>For labeling we are also going to use <code><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown()</a></code>
from <a href="https://wilkelab.org/ggtext/" class="external-link">{ggtext}</a> to work with
the labels that are needed to correctly display the isotopic signature.
If you are working other data please replace.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">posterior_plots</span> <span class="op">&lt;-</span> <span class="va">df_mu</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">isotope</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">mu_est</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sample_name</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.25</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                           option <span class="op">=</span> <span class="st">"D"</span>, name <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            axis.title.x <span class="op">=</span>  <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            axis.title.y <span class="op">=</span>  <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            legend.position <span class="op">=</span> <span class="st">"none"</span>,</span>
<span>            legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"\u00b5&lt;sub&gt;\U03B4&lt;/sub&gt;"</span>, <span class="st">"&lt;sub&gt;&lt;sup&gt;"</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">neutron</span><span class="op">)</span>, <span class="st">"&lt;/sup&gt;&lt;/sub&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;"</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">element</span><span class="op">)</span>, <span class="st">"&lt;/sub&gt;"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"p(\u00b5 &lt;sub&gt;\U03B4&lt;/sub&gt;"</span>,<span class="st">"&lt;sub&gt;&lt;sup&gt;"</span>,</span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">neutron</span><span class="op">)</span>, <span class="st">"&lt;/sub&gt;&lt;/sup&gt;"</span>,</span>
<span>                   <span class="st">"&lt;sub&gt;"</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">element</span><span class="op">)</span>,<span class="st">"&lt;/sub&gt;"</span>,</span>
<span>                   <span class="st">" | X)"</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">posterior_plots</span><span class="op">$</span><span class="va">d15n</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.18</span>, <span class="fl">0.82</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="va">posterior_plots</span><span class="op">$</span><span class="va">d13c</span></span></code></pre></div>
<p><img src="using-nichetools-with-the-package-nicheROVER_files/figure-html/unnamed-chunk-10-1.png" width="100%"></p>
<p>For labeling purposes we need to add columns that are the element
abbreviation and neutron number. I do this by using
<code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when()</a></code> which are vectorized if else statements.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_sigma_cn</span> <span class="op">&lt;-</span> <span class="va">df_sigma_cn</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    element_id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">id</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="st">"N"</span>,</span>
<span>      <span class="va">id</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="st">"C"</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    neutron_id <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">id</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="fl">15</span>,</span>
<span>      <span class="va">id</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="fl">13</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    element_iso <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="st">"N"</span>,</span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="st">"C"</span>,</span>
<span>    <span class="op">)</span>,</span>
<span>    neutron_iso <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="fl">15</span>,</span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="fl">13</span>,</span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Next we will plot the posteriors for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma_plots</span> <span class="op">&lt;-</span> <span class="va">df_sigma_cn</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">isotope</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">post_sample</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sample_name</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.25</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                           option <span class="op">=</span> <span class="st">"D"</span>, name <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            axis.title.x <span class="op">=</span>  <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            axis.title.y <span class="op">=</span>  <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>            legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"\U03A3"</span>,<span class="st">"&lt;sub&gt;\U03B4&lt;/sub&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;&lt;sup&gt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">neutron_id</span><span class="op">)</span>, <span class="st">"&lt;/sub&gt;&lt;/sup&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;"</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">element_id</span><span class="op">)</span>,<span class="st">"&lt;/sub&gt;"</span>,<span class="st">" "</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;\U03B4&lt;/sub&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;&lt;sup&gt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">neutron_iso</span><span class="op">)</span>, <span class="st">"&lt;/sub&gt;&lt;/sup&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;"</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">element_iso</span><span class="op">)</span>,<span class="st">"&lt;/sub&gt;"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"p("</span>, <span class="st">"\U03A3"</span>,<span class="st">"&lt;sub&gt;\U03B4&lt;/sub&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;&lt;sup&gt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">neutron_id</span><span class="op">)</span>, <span class="st">"&lt;/sub&gt;&lt;/sup&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;"</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">element_id</span><span class="op">)</span>,<span class="st">"&lt;/sub&gt;"</span>,<span class="st">" "</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;\U03B4&lt;/sub&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;&lt;sup&gt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">neutron_iso</span><span class="op">)</span>, <span class="st">"&lt;/sub&gt;&lt;/sup&gt;"</span>,</span>
<span>                  <span class="st">"&lt;sub&gt;"</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">element_iso</span><span class="op">)</span>,<span class="st">"&lt;/sub&gt;"</span>, <span class="st">" | X)"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">sigma_plots</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.82</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-nichetools-with-the-package-nicheROVER_files/figure-html/unnamed-chunk-12-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="estimate-niche-ellipse">Estimate niche ellipse<a class="anchor" aria-label="anchor" href="#estimate-niche-ellipse"></a>
</h3>
<p>We then will use <code><a href="../reference/niche_ellipse.html">niche_ellipse()</a></code> to easily extract
ellipse for each
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î£</mi><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math>
estimate (i.e., 1000). If you are to have additional isotopes or
metrics, you will need to create mu and sigma objects for each pairing,
as currently this function only handles two isotopes. In the future,
there likely will be the ability to specify the number of isotopes you
have with the default being two. The reason for the lack of
functionality is <code><a href="https://dmurdoch.github.io/ellipse/reference/ellipse.html" class="external-link">ellipse::ellipse()</a></code> can only work within
two-dimensions, not three, so you will have to create multiple
<code><a href="https://rdrr.io/pkg/nicheROVER/man/ellipse.html" class="external-link">ellipse()</a></code> calls for each combination of isotopes or metrics
and I havenâ€™t had the time to implement this. The function will also
tell you how long it took to process as with large sets of isotope data
it is nice to know the time it takes for the function to work. The
function also has the argument <code>random</code> which by default is
set to <code>TRUE</code>. This argument randomly subsamples and returns
10 ellipse estimates out of the total number of samples taken in this
case it is 1,000. The <code>set_seed</code> argument allows you to
change the <code>set.seed</code> value by giving a numerical value to
make the results of the function reproducable, default is a random
value. I highly suggest using set_seed otherwise it will subsample
different values, there is no default value because CRAN will not allow
for a default value. You can change the number of subsamples but 10
seems pretty standard. If youâ€™d like all 1,000 ellipses you can set
<code>random</code> to <code>FALSE</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/niche_ellipse.html">niche_ellipse</a></span><span class="op">(</span>dat_mu <span class="op">=</span> <span class="va">df_mu</span>, dat_sigma <span class="op">=</span> <span class="va">df_sigma</span>,</span>
<span>                            set_seed <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; â†’ Total time processing was 0.06 secs</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-ellipses-densities-of-each-istope-and-isotope-biplot">Plot ellipses, densities of each istope, and isotope biplot<a class="anchor" aria-label="anchor" href="#plot-ellipses-densities-of-each-istope-and-isotope-biplot"></a>
</h3>
<p>We will first plot the ellipse for each sample_name</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ellipse_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_polygon.html" class="external-link">geom_polygon</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ellipse_df</span>,</span>
<span>               mapping <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">d13c</span>, y <span class="op">=</span> <span class="va">d15n</span>,</span>
<span>                             group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/interaction.html" class="external-link">interaction</a></span><span class="op">(</span><span class="va">sample_number</span>, <span class="va">sample_name</span><span class="op">)</span>,</span>
<span>                             color <span class="op">=</span> <span class="va">sample_name</span><span class="op">)</span>,</span>
<span>               fill <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>               linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_colour_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.25</span>, end <span class="op">=</span> <span class="fl">0.75</span>, </span>
<span>                         option <span class="op">=</span> <span class="st">"D"</span>, name <span class="op">=</span> <span class="st">"species"</span>,</span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">40</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">16</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        legend.position <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>        legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span> <span class="op">^</span> <span class="fl">13</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span> <span class="op">^</span> <span class="fl">15</span>, <span class="st">"N"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We need to turn <code>df</code> into long format to iterate over
using <code><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap()</a></code> to easily create density plots. You will
notice that I again use <code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when()</a></code> to make columns of
element abbreviations and neutron numbers that will be used in plot
labeling.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iso_long</span> <span class="op">&lt;-</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="va">species</span>,</span>
<span>               names_to <span class="op">=</span> <span class="st">"isotope"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"value"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    element <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="st">"N"</span>,</span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="st">"C"</span>,</span>
<span>    <span class="op">)</span>, </span>
<span>    neutron <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d15n"</span> <span class="op">~</span> <span class="fl">15</span>,</span>
<span>      <span class="va">isotope</span> <span class="op">==</span> <span class="st">"d13c"</span> <span class="op">~</span> <span class="fl">13</span>,</span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We will then make density plots for each isotope using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density()</a></code></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iso_density</span> <span class="op">&lt;-</span> <span class="va">iso_long</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="va">isotope</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap</a></span><span class="op">(</span></span>
<span>    <span class="op">~</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, </span>
<span>                       fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span>, </span>
<span>                   alpha <span class="op">=</span> <span class="fl">0.35</span>, </span>
<span>                   linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.25</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                           option <span class="op">=</span> <span class="st">"D"</span>, name <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>            panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>, <span class="fl">0.55</span><span class="op">)</span>, </span>
<span>            legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>            axis.title.x <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html" class="external-link">element_markdown</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"\U03B4"</span>,</span>
<span>                      <span class="st">"&lt;sup&gt;"</span>, <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">neutron</span><span class="op">)</span>, <span class="st">"&lt;/sup&gt;"</span>,<span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">element</span><span class="op">)</span>, </span>
<span>                      sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>, </span>
<span>           y <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">d13c_density</span> <span class="op">&lt;-</span> <span class="va">iso_density</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">34</span>, <span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">34</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">d15n_density</span> <span class="op">&lt;-</span> <span class="va">iso_density</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span>, <span class="fl">2.5</span><span class="op">)</span>, </span>
<span>                     limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">15</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Lastly we will use <code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code> to make isotopic
biplot.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iso_biplot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">d13c</span>, y <span class="op">=</span> <span class="va">d15n</span>,</span>
<span>                            fill <span class="op">=</span> <span class="va">species</span><span class="op">)</span>,</span>
<span>             shape <span class="op">=</span> <span class="fl">21</span>, colour <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>             stroke <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.70</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.25</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                       option <span class="op">=</span> <span class="st">"D"</span>, name <span class="op">=</span> <span class="st">"species"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="op">-</span><span class="fl">39</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">17</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>,</span>
<span>        panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        legend.position <span class="op">=</span> <span class="st">"none"</span>, </span>
<span>        legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span> <span class="op">^</span> <span class="fl">13</span>, <span class="st">"C"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">delta</span> <span class="op">^</span> <span class="fl">15</span>, <span class="st">"N"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="use-patchwork-to-make-ellipse-density-and-biplots-into-a-paneled-figure-">Use {patchwork} to make ellipse, density, and biplots into a paneled
figure.<a class="anchor" aria-label="anchor" href="#use-patchwork-to-make-ellipse-density-and-biplots-into-a-paneled-figure-"></a>
</h3>
<p>We can also use the function <code><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation()</a></code> to add
lettering to the figure that can be used in the figure description. To
maneuver where <code><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation()</a></code> places the lettering, we
need to add <code>plot.tag.position = c(x, y)</code> to the
<code><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme()</a></code> call in every plot.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">d13c_density</span> <span class="op">+</span> <span class="va">ellipse_plots</span> <span class="op">+</span> <span class="va">iso_biplot</span> <span class="op">+</span> <span class="va">d15n_density</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html" class="external-link">plot_annotation</a></span><span class="op">(</span>tag_levels <span class="op">=</span> <span class="st">"a"</span>, </span>
<span>                  tag_suffix <span class="op">=</span> <span class="st">")"</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-nichetools-with-the-package-nicheROVER_files/figure-html/unnamed-chunk-18-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="determine-the-95-niche-similarties-for-each-species">Determine the 95% niche similarties for each species<a class="anchor" aria-label="anchor" href="#determine-the-95-niche-similarties-for-each-species"></a>
</h3>
<p>We will use the <code><a href="https://rdrr.io/pkg/nicheROVER/man/overlap.html" class="external-link">overlap()</a></code> function from <a href="https://cran.r-project.org/package=nicheROVER" class="external-link">{nicheROVER}</a>)
to estimate the percentage of similarity among species. We will set
overlap to assess based on 95% similarities.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">over_stat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nicheROVER/man/overlap.html" class="external-link">overlap</a></span><span class="op">(</span><span class="va">fish_par</span>, nreps <span class="op">=</span> <span class="va">nsample</span>, nprob <span class="op">=</span> <span class="fl">1000</span>, </span>
<span>                     alpha <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span></code></pre></div>
<p>We then are going transform this output to a data frame using
<code><a href="../reference/extract_overlap.html">extract_overlap()</a></code> plotting so we can assess overall
similarities among species.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">over_stat_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_overlap.html">extract_overlap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">over_stat</span><span class="op">)</span></span></code></pre></div>
<p>We then are going to take our newly made data frame and extract out
the median percentage of similarities and the 2.5% and 97.5%
quantiles.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">over_sum</span> <span class="op">&lt;-</span> <span class="va">over_stat_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">sample_name_a</span>, <span class="va">sample_name_b</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    median_niche_overlap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">niche_overlap_perc</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    qual_2.5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">niche_overlap_perc</span>, </span>
<span>                              probs <span class="op">=</span> <span class="fl">0.025</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, </span>
<span>    qual_97.5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">niche_overlap_perc</span>, </span>
<span>                               probs <span class="op">=</span> <span class="fl">0.975</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sample_name_a</span>, <span class="va">sample_name_b</span>, <span class="va">median_niche_overlap</span><span class="op">)</span>, </span>
<span>               names_to <span class="op">=</span> <span class="st">"percentage"</span>, </span>
<span>               values_to <span class="op">=</span> <span class="st">"niche_overlap_qual"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    percentage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">percentage</span>, <span class="st">"qual_"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p>We are now going to use <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>,
<code><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin()</a></code>, and <code><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary()</a></code> to represent
the posterior distributions and the median of the posterior
distributions. Representations of posterior distributions should either
use the mode or median, not the mean. See the following publication as a
guide to representation of posterior distributions in vizialations and
in text. You can extract credible intervals or the equal-tailed
intervals using <a href="https://easystats.github.io/bayestestR/" class="external-link">{bayestestR}</a>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">over_stat_df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample_name_a</span>, </span>
<span>                                y <span class="op">=</span> <span class="va">niche_overlap_perc</span>, </span>
<span>                                fill <span class="op">=</span> <span class="va">sample_name_b</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun.y <span class="op">=</span> <span class="va">median</span>, geom <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>               size <span class="op">=</span> <span class="fl">3</span>, </span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">3.5</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>             linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_fill_viridis_d</a></span><span class="op">(</span>begin <span class="op">=</span> <span class="fl">0.25</span>, end <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>                       option <span class="op">=</span> <span class="st">"D"</span>, name <span class="op">=</span> <span class="st">"Species"</span>, </span>
<span>                       alpha <span class="op">=</span> <span class="fl">0.35</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>, </span>
<span>    legend.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    strip.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Overlap Probability (%)"</span>, <span class="st">"\u2013"</span>, </span>
<span>                 <span class="st">"Niche Region Size: 95%"</span><span class="op">)</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"p(Percent Overlap | X)"</span><span class="op">)</span></span></code></pre></div>
<p><img src="using-nichetools-with-the-package-nicheROVER_files/figure-html/unnamed-chunk-22-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="estimate-overall-niche-size">Estimate overall niche size<a class="anchor" aria-label="anchor" href="#estimate-overall-niche-size"></a>
</h3>
<p>We are now going to estimate the overall size of the niche for each
posterior sample by using the function <code><a href="../reference/extract_niche_size.html">extract_niche_size()</a></code>
which is a wrapper around <code><a href="https://rdrr.io/pkg/nicheROVER/man/niche.size.html" class="external-link">niche.size()</a></code> and some data
manipulation functions.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">niche_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_niche_size.html">extract_niche_size</a></span><span class="op">(</span><span class="va">fish_par</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-niche-size">Plot niche size<a class="anchor" aria-label="anchor" href="#plot-niche-size"></a>
</h3>
<p>We will now use <code><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin()</a></code>,
<code><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point()</a></code>, and <code><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar()</a></code> to plot the
distribution for niche size for each species.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">niche_size</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample_name</span>, y <span class="op">=</span> <span class="va">niche_size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span></span>
<span>    </span>
<span>    width <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html" class="external-link">stat_summary</a></span><span class="op">(</span>fun.y <span class="op">=</span> <span class="va">median</span>, geom <span class="op">=</span> <span class="st">"point"</span>, </span>
<span>               size <span class="op">=</span> <span class="fl">3</span>, </span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>        axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Species"</span>, </span>
<span>       y <span class="op">=</span> <span class="st">"Niche Size"</span><span class="op">)</span> </span></code></pre></div>
<p><img src="using-nichetools-with-the-package-nicheROVER_files/figure-html/unnamed-chunk-24-1.png" width="700"></p>
<p>Now that we have our niche sizes and similarities determined we can
make inferences about the species, trophic similarities, and the
ecosystem.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://benjaminhlina.com" class="external-link">Benjamin L. Hlina</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
